!function e(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):"object"==typeof exports?exports.JSONForms=n():t.JSONForms=n()}(this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={exports:{},id:r,loaded:!1};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){"use strict";function r(e){return/^\d+$/.test(e)}function a(e,t,n,r,o){if(o&&(r={name:"filename",type:"filetype",body:"filebody"}),t.last){if(void 0===n)t.append?e.push(r):("null"==r&&(r=null),e[t.key]=r);else if(n.constructor==Array)"null"==r&&(r=null),e[t.key].push(r);else{if(n.constructor==Object&&!o)return a(n,{key:"",last:!0,type:"object"},n[""],r,o);e[t.key]=[n,r]}return e}if(void 0===n)return"array"===t.nextType?e[t.key]=[]:e[t.key]={},e[t.key];if(n.constructor===Object)return e[t.key];if(n.constructor===Array){if("array"===t.nextType)return n;var u={};return n.forEach(function(n,r){void 0!==n?u[r]=n:e[t.key]=u}),u}var u={"":n};return e[t.key]=u,u}function o(e){var t,n=(t=e,[].concat(Array.prototype.slice.call(t.querySelectorAll("input:not([type=submit])")).map(function(e){var t={name:e.name,value:e.value};switch(e.type){case"checkbox":t.value=e.checked;break;case"number":t.value=parseInt(e.value,10);break;case"radio":if(!e.checked)return null;t.value,e.value}return t})).concat(Array.prototype.slice.call(t.querySelectorAll("select:not([multiple])")).map(function(e){return{name:e.name,value:e.value}})).concat(Array.prototype.slice.call(t.querySelectorAll("select[multiple] option[selected]")).map(function(e){return{name:function e(t,n){for(n=n.toLowerCase();t&&t.parentNode;)if((t=t.parentNode).tagName&&t.tagName.toLowerCase()==n)return t;return null}(e,"select").name,value:e.value}})).concat(Array.prototype.slice.call(t.querySelectorAll("textarea")).map(function(e){return{name:e.name,value:e.value}})).filter(function(e){return e})),o={};return n.forEach(function(e){for(var t=e.value&&void 0!==e.value.body,n=function e(t){var n,a=t,o=[],u=!1,l=t.substr(0,t.indexOf("["));for(l.length?(t=t.substr(t.indexOf("["),t.length),o.push({key:l,last:!t.length,type:"object"})):u=!0,n=t.substr(1,t.indexOf("]")-1);t.length&&!u;)"["===t[0]&&"]"===t[1]?(o.push({append:!0,type:"array"}),u=0!==(t=t.substr(2,t.length)).length):r(n=t.substr(1,t.indexOf("]")-1))?(n=parseInt(n,10),t=t.substr(t.indexOf("]")+1,t.length),o.push({key:n,type:"array"})):(n=t.substr(1,t.indexOf("]")-1))&&-1===n.indexOf("[")?(t=t.substr(t.indexOf("]")+1,t.length),o.push({key:n,type:"object"})):u=!0;if(u)o=[{key:a,last:!0,type:"object"}];else for(var c=0;c<o.length;c++){var s=o[c],i=o[c+1];i?s.nextType=i.type:s.last=!0}return o}(e.name),u=o,l=0;l<n.length;l++){var c=n[l],s=u[c.key];u=a(u,c,s,e.value,t)}}),o}function u(e){var t,n,r=e.target;"FORM"===r.tagName&&"application/json"===r.getAttribute("enctype")&&(e.preventDefault(),t=JSON.stringify(o(r)),(n=new XMLHttpRequest).open("POST",r.action),n.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.send(t),n.onload=function(){n.status>200&&n.status<400?console.log("success :)"):console.log("failure :(")})}e.exports={enable:function(){addEventListener("submit",u)},encode:o,disable:function(){removeEventListener("submit",u)}}}])});
